<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voto25 - Sistemi Online i Votingut</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #000000;
            color: #FFFFFF;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header Styles */
        header {
            background-color: #000000;
            color: #FFFFFF;
            padding: 1rem 0;
            box-shadow: 0 2px 5px rgba(255, 0, 0, 0.3);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 600;
            color: #FFFFFF;
        }

        nav ul {
            display: flex;
            list-style: none;
        }

        nav ul li {
            margin-left: 1.5rem;
        }

        nav ul li a {
            color: #FFFFFF;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            padding: 0.5rem 1rem;
            border-radius: 4px;
        }

        nav ul li a:hover {
            background-color: #FF0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
        }

        /* Main Content */
        main {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            padding: 20px;
        }

        /* Page Styles */
        .page {
            display: none;
            animation: fadeIn 0.5s;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), 
                        url('https://images.unsplash.com/photo-1529107386315-e1a2ed48a620?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            min-height: 60vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: #FFFFFF;
            padding: 2rem 20px;
            border-radius: 8px;
            margin-bottom: 2rem;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
        }

        .hero h2 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.7);
        }

        .hero p {
            font-size: clamp(1rem, 3vw, 1.5rem);
            max-width: 700px;
            margin-bottom: 2rem;
        }

        /* Choice Section */
        .choice-section {
            text-align: center;
            margin: 3rem 0;
        }

        .choice-section h2 {
            color: #FFFFFF;
            margin-bottom: 2rem;
            font-size: clamp(1.8rem, 4vw, 2.5rem);
        }

        .choice-cards {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .choice-card {
            background: #000000;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
            text-align: center;
            transition: all 0.3s;
            border: 1px solid rgba(255, 0, 0, 0.3);
            flex: 1;
            min-width: 280px;
            max-width: 350px;
            cursor: pointer;
        }

        .choice-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 25px rgba(255, 0, 0, 0.5);
        }

        .choice-card h3 {
            color: #FFFFFF;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .choice-card p {
            color: #CCCCCC;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        /* Admin Code Section */
        .admin-code-section {
            text-align: center;
            margin: 2rem auto;
            max-width: 500px;
            padding: 0 20px;
        }

        .admin-code-section h3 {
            color: #FFFFFF;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .code-input {
            width: 100%;
            padding: 1rem;
            background-color: #000000;
            color: #FFFFFF;
            border: 1px solid rgba(255, 0, 0, 0.5);
            border-radius: 4px;
            font-size: 1.2rem;
            text-align: center;
            margin-bottom: 1rem;
        }

        .code-input:focus {
            outline: none;
            border-color: #FF0000;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.7);
        }

        /* Welcome Section */
        .welcome {
            background: #000000;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 0, 0, 0.3);
        }

        .welcome h2 {
            color: #FFFFFF;
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 1.8rem;
        }

        .welcome p {
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        /* Form Styles */
        .form-container {
            max-width: 500px;
            margin: 2rem auto;
            background: #000000;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
            border: 1px solid rgba(255, 0, 0, 0.3);
        }

        .form-container h2 {
            color: #FFFFFF;
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #FFFFFF;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            background-color: #000000;
            color: #FFFFFF;
            border: 1px solid rgba(255, 0, 0, 0.5);
            border-radius: 4px;
            font-size: 1rem;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #FF0000;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.7);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .checkbox-group input {
            width: auto;
            margin-right: 0.5rem;
        }

        .checkbox-group label {
            color: #FFFFFF;
        }

        /* Button Styles */
        .btn {
            display: inline-block;
            background-color: #FF0000;
            color: #FFFFFF;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            text-align: center;
        }

        .btn:hover {
            background-color: #CC0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
        }

        .btn-secondary {
            background-color: #333333;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background-color: #555555;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }

        .btn-danger {
            background-color: #990000;
        }

        .btn-danger:hover {
            background-color: #770000;
        }

        .btn-success {
            background-color: #006600;
        }

        .btn-success:hover {
            background-color: #008800;
        }

        .btn:disabled {
            background-color: #666666;
            cursor: not-allowed;
            box-shadow: none;
        }

        .btn:disabled:hover {
            background-color: #666666;
            box-shadow: none;
        }

        .form-footer {
            text-align: center;
            margin-top: 1.5rem;
        }

        .form-footer a {
            color: #FF0000;
            text-decoration: none;
        }

        .form-footer a:hover {
            text-decoration: underline;
            text-shadow: 0 0 5px rgba(255, 0, 0, 0.7);
        }

        /* Dashboard Styles */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 0, 0, 0.3);
            flex-wrap: wrap;
            gap: 1rem;
        }

        .dashboard-nav {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .user-profile {
            background: #000000;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 0, 0, 0.3);
        }

        .user-profile h2 {
            color: #FFFFFF;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .user-profile h3 {
            color: #FF0000;
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
        }

        .profile-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .info-item {
            padding: 1rem;
            background: #111111;
            border-radius: 4px;
            border: 1px solid rgba(255, 0, 0, 0.2);
        }

        .info-item strong {
            color: #FF0000;
        }

        /* Election Styles */
        .election-container {
            background: #000000;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 0, 0, 0.3);
        }

        .election-container h1 {
            color: #FFFFFF;
            margin-bottom: 1rem;
            text-align: center;
            font-size: 1.8rem;
        }

        .election-container h2 {
            color: #FF0000;
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 1.5rem;
        }

        .candidates-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        .candidates-table th, .candidates-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 0, 0, 0.3);
            color: #FFFFFF;
        }

        .candidates-table th {
            background-color: #111111;
            color: #FF0000;
            font-weight: 600;
        }

        .candidates-table tr:hover {
            background-color: #111111;
        }

        /* Admin Styles */
        .admin-container {
            display: flex;
            min-height: 70vh;
            flex-direction: column;
        }

        .admin-sidebar {
            width: 100%;
            background: #000000;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
            border: 1px solid rgba(255, 0, 0, 0.3);
            margin-bottom: 1rem;
        }

        .admin-sidebar ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .admin-sidebar li {
            margin-bottom: 0;
        }

        .admin-sidebar a {
            display: block;
            padding: 0.8rem 1rem;
            color: #FFFFFF;
            text-decoration: none;
            border-radius: 4px;
            transition: all 0.3s;
            white-space: nowrap;
            cursor: pointer;
        }

        .admin-sidebar a:hover, .admin-sidebar a.active {
            background-color: #FF0000;
            color: #FFFFFF;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
        }

        .admin-content {
            flex: 1;
            background: #000000;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
            border: 1px solid rgba(255, 0, 0, 0.3);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 0, 0, 0.3);
            flex-wrap: wrap;
            gap: 1rem;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 2rem;
            overflow-x: auto;
            display: block;
        }

        .admin-table th, .admin-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 0, 0, 0.3);
            color: #FFFFFF;
        }

        .admin-table th {
            background-color: #111111;
            color: #FF0000;
            font-weight: 600;
        }

        .admin-table tr:hover {
            background-color: #111111;
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        /* Admin Options Styles */
        .admin-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .admin-option-card {
            background: #000000;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
            text-align: center;
            transition: all 0.3s;
            border: 1px solid rgba(255, 0, 0, 0.3);
            cursor: pointer;
        }

        .admin-option-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(255, 0, 0, 0.5);
        }

        .admin-option-card h3 {
            color: #FFFFFF;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .admin-option-card p {
            color: #CCCCCC;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        /* Tabs Styles */
        .tabs {
            display: flex;
            margin-bottom: 2rem;
            border-bottom: 1px solid rgba(255, 0, 0, 0.3);
            flex-wrap: wrap;
        }

        .tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab.active {
            border-bottom: 3px solid #FF0000;
            color: #FF0000;
        }

        .tab:hover {
            color: #FF0000;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Alert Styles */
        .alert {
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1rem;
            text-align: center;
        }

        .alert-error {
            background-color: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.5);
            color: #FF9999;
        }

        .alert-success {
            background-color: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.5);
            color: #99FF99;
        }

        .alert-info {
            background-color: rgba(0, 100, 255, 0.2);
            border: 1px solid rgba(0, 100, 255, 0.5);
            color: #99CCFF;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #ffffff;
            border-radius: 50%;
            border-top-color: #FF0000;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #007bff;
        }

        /* Footer */
        footer {
            background-color: #000000;
            color: #FFFFFF;
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
            box-shadow: 0 -2px 5px rgba(255, 0, 0, 0.3);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }

            nav ul {
                margin-top: 0;
                flex-wrap: wrap;
                justify-content: center;
                gap: 0.5rem;
            }

            nav ul li {
                margin: 0;
            }

            .hero {
                min-height: 50vh;
                padding: 1.5rem 15px;
            }

            .choice-cards {
                gap: 1.5rem;
            }

            .choice-card {
                padding: 1.5rem;
                min-width: 100%;
            }

            .admin-sidebar ul {
                flex-direction: column;
            }

            .admin-sidebar a {
                text-align: center;
            }

            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .dashboard-nav {
                width: 100%;
                justify-content: space-between;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                padding: 0.8rem 1rem;
                text-align: center;
            }

            .form-container {
                padding: 1.5rem;
                margin: 1rem auto;
            }

            .user-profile, .election-container, .admin-content {
                padding: 1.5rem;
            }

            .profile-info {
                grid-template-columns: 1fr;
            }

            .admin-options {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .admin-option-card {
                padding: 1.5rem;
            }

            .candidates-table, .admin-table {
                font-size: 0.9rem;
            }

            .candidates-table th, .candidates-table td,
            .admin-table th, .admin-table td {
                padding: 0.8rem 0.5rem;
            }

            .stats-bar {
                flex-direction: column;
                gap: 10px;
            }
        }

        @media (max-width: 480px) {
            .hero {
                min-height: 40vh;
            }

            .hero h2 {
                font-size: 1.8rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .choice-card {
                padding: 1rem;
            }

            .form-container {
                padding: 1rem;
            }

            .dashboard-nav {
                flex-direction: column;
                gap: 0.5rem;
            }

            .btn {
                width: 100%;
                padding: 1rem;
            }

            .admin-sidebar a {
                padding: 1rem 0.8rem;
                font-size: 0.9rem;
            }

            .user-profile h2, .election-container h1 {
                font-size: 1.5rem;
            }

            .user-profile h3, .election-container h2 {
                font-size: 1.2rem;
            }
        }

        /* Scrollable tables for mobile */
        .table-container {
            overflow-x: auto;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="header-container">
            <div class="logo">
                <h1>Voto25</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="#" onclick="showPage('home')">Kryefaqja</a></li>
                    <li><a href="#" onclick="showPage('choice')">Fillo</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Home Page -->
        <section id="home" class="page active">
            <div class="hero">
                <h2>Voto25</h2>
                <p>Sistemi i Sigurt, Transparent dhe i Aksesuesh√´m i Votingut Online</p>
                <a href="#" class="btn" onclick="showPage('choice')">Fillo Tani</a>
            </div>

            <div class="welcome">
                <h2>Mir√´sevini n√´ Voto25</h2>
                <p>Ne jemi t√´ p√´rkushtuar p√´r t√´ revolucionarizuar procesin demokratik p√´rmes zgjidhjeve inovative t√´ votingut online. Platforma jon√´ √´sht√´ krijuar p√´r t√´ fuqizuar individ√´t dhe organizatat duke ofruar nj√´ p√´rvoj√´ t√´ sigurt, t√´ aksesueshme dhe transparente t√´ votimit.</p>
                <p>Jemi t√´ lumtur q√´ ju keni bashkuar me ne p√´r t√´ formuar t√´ ardhmen p√´rmes fuqis√´ s√´ vot√´s suaj. Platforma jon√´ e votingut online √´sht√´ krijuar p√´r ta b√´r√´ procesin e votimit t√´ p√´rshtatsh√´m, t√´ sigurt dhe t√´ aksesuesh√´m p√´r t√´ gjith√´ pjes√´marr√´sit e p√´rshtatsh√´m.</p>
            </div>
        </section>

        <!-- Choice Page -->
        <section id="choice" class="page">
            <div class="hero">
                <h2>ZGJIDHNI ROLIN TUAJ</h2>
                <p>Zgjidhni n√´se jeni Administrator apo Votues</p>
            </div>

            <div class="choice-section">
                <div class="choice-cards">
                    <div class="choice-card" onclick="showPage('admin-code')">
                        <h3>Administrator</h3>
                        <p>Menaxhoni sistemin e votimit, regjistroni partit√´, kandidat√´t dhe votuesit. Mbik√´qyrni t√´ gjith√´ procesin zgjedhor.</p>
                        <button class="btn">Vazhdo si Admin</button>
                    </div>
                    <div class="choice-card" onclick="showPage('voter-login')">
                        <h3>Votues</h3>
                        <p>Regjistrohuni p√´r t√´ votuar dhe merrni pjes√´ n√´ zgjedhje. Votoni n√´ m√´nyr√´ t√´ sigurt p√´r kandidat√´t e preferuar.</p>
                        <button class="btn">Vazhdo si Votues</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Code Page -->
        <section id="admin-code" class="page">
            <div class="hero">
                <h2>HYRJE ADMINISTRATORI</h2>
                <p>Ju lutem shkruani kodin e administratorit p√´r t√´ vazhduar</p>
            </div>

            <div class="admin-code-section">
                <h3>Kodi i Administratorit</h3>
                <input type="password" id="adminCode" class="code-input" placeholder="Shkruani kodin k√´tu">
                <button class="btn" onclick="verifyAdminCode()" id="admin-login-btn">
                    <span id="admin-login-text">Verifiko Kodin</span>
                    <span id="admin-loading" class="loading" style="display: none;"></span>
                </button>
                <div id="admin-code-error" class="alert alert-error" style="display: none;">
                    Kodi i administratorit √´sht√´ i gabuar. Ju lutem provoni p√´rs√´ri.
                </div>
            </div>
        </section>

        <!-- Admin Options Page -->
        <section id="admin-options" class="page">
            <div class="dashboard-header">
                <h1>Paneli i Administratorit</h1>
                <div class="dashboard-nav">
                    <a href="#" class="btn" onclick="showPage('choice')">Kthehu</a>
                    <a href="#" class="btn btn-danger" onclick="logout()">Dil</a>
                </div>
            </div>

            <div class="admin-container">
                <div class="admin-sidebar">
                    <ul>
                        <li><a href="#" onclick="showPage('register-party')">Regjistro Parti</a></li>
                        <li><a href="#" onclick="showPage('register-voter')">Regjistro Votues</a></li>
                        <li><a href="#" onclick="showPage('register-candidate')">Regjistro Kandidat</a></li>
                    </ul>
                </div>

                <div class="admin-content">
                    <!-- Tabs p√´r shikimin e t√´ dh√´nave -->
                    <div class="tabs-container">
                        <div class="tabs">
                            <div class="tab active" onclick="showTab('voters-tab')">Votuesit</div>
                            <div class="tab" onclick="showTab('candidates-tab')">Kandidat√´t</div>
                            <div class="tab" onclick="showTab('parties-tab')">Partit√´</div>
                            <div class="tab" onclick="showTab('results-tab')">Rezultatet</div>
                            <div class="tab" onclick="showTab('party-results-tab')">Rezultatet e Partive</div>
                        </div>

                        <!-- Votuesit -->
                        <div id="voters-tab" class="tab-content active">
                            <h2>Votuesit e Regjistruar</h2>
                            <div id="voters-loading" class="alert alert-info" style="display: none;">
                                <span class="loading"></span> Duke ngarkuar votuesit...
                            </div>
                            <div class="table-container">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>Emri</th>
                                            <th>Mbiemri</th>
                                            <th>Email</th>
                                            <th>ID Votuesi</th>
                                            <th>Qyteti</th>
                                            <th>Mosha</th>
                                            <th>Statusi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="registered-voters-list">
                                        <tr>
                                            <td colspan="7" style="text-align: center;">Nuk ka votues t√´ regjistruar</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Kandidat√´t -->
                        <div id="candidates-tab" class="tab-content">
                            <h2>Kandidat√´t e Regjistruar</h2>
                            <div id="candidates-loading" class="alert alert-info" style="display: none;">
                                <span class="loading"></span> Duke ngarkuar kandidat√´t...
                            </div>
                            <div class="table-container">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>Emri</th>
                                            <th>Partia</th>
                                            <th>Qyteti</th>
                                            <th>Mosha</th>
                                            <th>Kualifikimet</th>
                                        </tr>
                                    </thead>
                                    <tbody id="registered-candidates-list">
                                        <tr>
                                            <td colspan="5" style="text-align: center;">Nuk ka kandidat√´ t√´ regjistruar</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Partit√´ -->
                        <div id="parties-tab" class="tab-content">
                            <h2>Partit√´ e Regjistruara</h2>
                            <div id="parties-loading" class="alert alert-info" style="display: none;">
                                <span class="loading"></span> Duke ngarkuar partit√´...
                            </div>
                            <div class="table-container">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>Emri i Partis√´</th>
                                            <th>Simboli</th>
                                            <th>Kryetari</th>
                                            <th>Viti i Themeltimit</th>
                                            <th>Ideologjia</th>
                                        </tr>
                                    </thead>
                                    <tbody id="registered-parties-list">
                                        <tr>
                                            <td colspan="5" style="text-align: center;">Nuk ka parti t√´ regjistruara</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Rezultatet e Votimit -->
                        <div id="results-tab" class="tab-content">
                            <h2>üìä Rezultatet e Votimit</h2>
                            <div class="stats-bar">
                                <div class="stat-item">
                                    <span class="stat-label">Total Vota:</span>
                                    <span class="stat-value" id="total-votes">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">P√´rdit√´suar:</span>
                                    <span class="stat-value" id="last-updated">-</span>
                                </div>
                            </div>
                            
                            <div id="results-loading" class="alert alert-info" style="display: none;">
                                <span class="loading"></span> Duke ngarkuar rezultatet...
                            </div>
                            
                            <div class="table-container">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>Pozita</th>
                                            <th>Kandidati</th>
                                            <th>Partia</th>
                                            <th>Qyteti</th>
                                            <th>Vota</th>
                                            <th>P√´rqindja</th>
                                        </tr>
                                    </thead>
                                    <tbody id="voting-results-list">
                                        <tr>
                                            <td colspan="6" style="text-align: center;">Kliko "Rezultatet" p√´r t√´ shfaqur t√´ dh√´nat</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <button class="btn btn-primary" onclick="showResults()">
                                <span id="refresh-results-text">üîÑ Rifresko Rezultatet</span>
                            </button>
                        </div>

                        <!-- Rezultatet e Partive -->
                        <div id="party-results-tab" class="tab-content">
                            <h2>üèõÔ∏è Rezultatet e Partive</h2>
                            <div class="stats-bar">
                                <div class="stat-item">
                                    <span class="stat-label">Total Vota:</span>
                                    <span class="stat-value" id="total-party-votes">0</span>
                                </div>
                            </div>
                            
                            <div id="party-results-loading" class="alert alert-info" style="display: none;">
                                <span class="loading"></span> Duke ngarkuar rezultatet e partive...
                            </div>
                            
                            <div class="table-container">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>Pozita</th>
                                            <th>Partia</th>
                                            <th>Vota Totale</th>
                                            <th>P√´rqindja</th>
                                        </tr>
                                    </thead>
                                    <tbody id="party-results-list">
                                        <tr>
                                            <td colspan="4" style="text-align: center;">Kliko "Rezultatet e Partive" p√´r t√´ shfaqur t√´ dh√´nat</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <button class="btn btn-primary" onclick="showPartyResults()">
                                <span id="refresh-party-results-text">üîÑ Rifresko Rezultatet</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Register Party Page -->
        <section id="register-party" class="page">
            <div class="dashboard-header">
                <h1>Regjistro Parti t√´ Re</h1>
                <div class="dashboard-nav">
                    <a href="#" class="btn" onclick="showPage('admin-options')">Kthehu te Admini</a>
                    <a href="#" class="btn btn-danger" onclick="logout()">Dil</a>
                </div>
            </div>

            <div class="form-container">
                <h2>Formulari i Regjistrimit t√´ Partis√´</h2>
                <div id="party-success" class="alert alert-success" style="display: none;">
                    Partia u regjistrua me sukses!
                </div>
                <div id="party-error" class="alert alert-error" style="display: none;">
                </div>
                <form id="party-form">
                    <div class="form-group">
                        <label for="partyName">Emri i Partis√´</label>
                        <input type="text" id="partyName" name="partyName" required>
                    </div>
                    <div class="form-group">
                        <label for="partySymbol">Simboli i Partis√´</label>
                        <input type="text" id="partySymbol" name="partySymbol" required>
                    </div>
                    <div class="form-group">
                        <label for="partyLeader">Kryetari i Partis√´</label>
                        <input type="text" id="partyLeader" name="partyLeader" required>
                    </div>
                    <div class="form-group">
                        <label for="foundingYear">Viti i Themeltimit</label>
                        <input type="number" id="foundingYear" name="foundingYear" min="1900" max="2024" required>
                    </div>
                    <div class="form-group">
                        <label for="partyIdeology">Ideologjia e Partis√´</label>
                        <textarea id="partyIdeology" name="partyIdeology" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="btn" id="party-submit-btn">
                        <span id="party-submit-text">Regjistro Partin√´</span>
                        <span id="party-loading" class="loading" style="display: none;"></span>
                    </button>
                </form>
            </div>
        </section>

        <!-- Register Voter Page -->
        <section id="register-voter" class="page">
            <div class="dashboard-header">
                <h1>Regjistro Votues t√´ Ri</h1>
                <div class="dashboard-nav">
                    <a href="#" class="btn" onclick="showPage('admin-options')">Kthehu te Admini</a>
                    <a href="#" class="btn btn-danger" onclick="logout()">Dil</a>
                </div>
            </div>

            <div class="form-container">
                <h2>Formulari i Regjistrimit t√´ Votuesit</h2>
                <div id="voter-success" class="alert alert-success" style="display: none;">
                    Votuesi u regjistrua me sukses!
                </div>
                <div id="voter-error" class="alert alert-error" style="display: none;">
                </div>
                <div id="voter-age-error" class="alert alert-error" style="display: none;">
                    Votuesi duhet t√´ jet√´ t√´ pakt√´n 18 vje√ß p√´r tu regjistruar.
                </div>
                <form id="voter-form">
                    <div class="form-group">
                        <label for="voterFirstName">Emri</label>
                        <input type="text" id="voterFirstName" name="voterFirstName" required>
                    </div>
                    <div class="form-group">
                        <label for="voterLastName">Mbiemri</label>
                        <input type="text" id="voterLastName" name="voterLastName" required>
                    </div>
                    <div class="form-group">
                        <label for="voterAge">Mosha</label>
                        <input type="number" id="voterAge" name="voterAge" min="18" max="120" required onchange="checkVoterAge()">
                    </div>
                    <div class="form-group">
                        <label for="voterDob">Data e Lindjes</label>
                        <input type="date" id="voterDob" name="voterDob" required onchange="calculateVoterAge()">
                    </div>
                    <div class="form-group">
                        <label for="voterEmail">Email</label>
                        <input type="email" id="voterEmail" name="voterEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="voterId">ID e Votuesit</label>
                        <input type="text" id="voterId" name="voterId" required>
                    </div>
                    <div class="form-group">
                        <label for="voterCity">Qyteti</label>
                        <select id="voterCity" name="voterCity" required>
                            <option value="">Zgjidhni Qytetin</option>
                            <option value="Tirana">Tirana</option>
                            <option value="Durr√´s">Durr√´s</option>
                            <option value="Vlor√´">Vlor√´</option>
                            <option value="Shkod√´r">Shkod√´r</option>
                            <option value="Elbasan">Elbasan</option>
                            <option value="Kor√ß√´">Kor√ß√´</option>
                            <option value="Fier">Fier</option>
                            <option value="Berat">Berat</option>
                            <option value="Lushnj√´">Lushnj√´</option>
                            <option value="Kavaj√´">Kavaj√´</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="voterAddress">Adresa</label>
                        <textarea id="voterAddress" name="voterAddress" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="btn" id="voter-submit-btn">
                        <span id="voter-submit-text">Regjistro Votuesin</span>
                        <span id="voter-loading" class="loading" style="display: none;"></span>
                    </button>
                </form>
            </div>
        </section>

        <!-- Register Candidate Page -->
        <section id="register-candidate" class="page">
            <div class="dashboard-header">
                <h1>Regjistro Kandidat t√´ Ri</h1>
                <div class="dashboard-nav">
                    <a href="#" class="btn" onclick="showPage('admin-options')">Kthehu te Admini</a>
                    <a href="#" class="btn btn-danger" onclick="logout()">Dil</a>
                </div>
            </div>

            <div class="form-container">
                <h2>Formulari i Regjistrimit t√´ Kandidatit</h2>
                <div id="candidate-success" class="alert alert-success" style="display: none;">
                    Kandidati u regjistrua me sukses!
                </div>
                <div id="candidate-error" class="alert alert-error" style="display: none;">
                </div>
                <div id="candidate-age-error" class="alert alert-error" style="display: none;">
                    Kandidati duhet t√´ jet√´ t√´ pakt√´n 25 vje√ß p√´r tu regjistruar.
                </div>
                <form id="candidate-form">
                    <div class="form-group">
                        <label for="candidateName">Emri i Kandidatit</label>
                        <input type="text" id="candidateName" name="candidateName" required>
                    </div>
                    <div class="form-group">
                        <label for="candidateParty">Partia Politike</label>
                        <select id="candidateParty" name="candidateParty" required>
                            <option value="">Zgjidhni Partin√´</option>
                            <!-- Partit√´ do t√´ mbushen automatikisht -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="candidateCity">Qyteti</label>
                        <select id="candidateCity" name="candidateCity" required>
                            <option value="">Zgjidhni Qytetin</option>
                            <option value="Tirana">Tirana</option>
                            <option value="Durr√´s">Durr√´s</option>
                            <option value="Vlor√´">Vlor√´</option>
                            <option value="Shkod√´r">Shkod√´r</option>
                            <option value="Elbasan">Elbasan</option>
                            <option value="Kor√ß√´">Kor√ß√´</option>
                            <option value="Fier">Fier</option>
                            <option value="Berat">Berat</option>
                            <option value="Lushnj√´">Lushnj√´</option>
                            <option value="Kavaj√´">Kavaj√´</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="candidateAge">Mosha</label>
                        <input type="number" id="candidateAge" name="candidateAge" min="25" max="120" required onchange="checkCandidateAge()">
                    </div>
                    <div class="form-group">
                        <label for="candidateDob">Data e Lindjes</label>
                        <input type="date" id="candidateDob" name="candidateDob" required onchange="calculateCandidateAge()">
                    </div>
                    <div class="form-group">
                        <label for="candidateQualification">Kualifikimet</label>
                        <textarea id="candidateQualification" name="candidateQualification" rows="3" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="candidateManifesto">Programi Zgjedhor</label>
                        <textarea id="candidateManifesto" name="candidateManifesto" rows="4" required></textarea>
                    </div>
                    <button type="submit" class="btn" id="candidate-submit-btn">
                        <span id="candidate-submit-text">Regjistro Kandidatin</span>
                        <span id="candidate-loading" class="loading" style="display: none;"></span>
                    </button>
                </form>
            </div>
        </section>

        <!-- Voter Login Page -->
        <section id="voter-login" class="page">
            <div class="form-container">
                <h2>Hyrja e Votuesit</h2>
                <div id="voter-login-error" class="alert alert-error" style="display: none;">
                    ID e votuesit nuk √´sht√´ e regjistruar. Ju lutem kontaktoni administratorin.
                </div>
                <form id="voter-login-form">
                    <div class="form-group">
                        <label for="voterIdLogin">ID e Votuesit</label>
                        <input type="text" id="voterIdLogin" name="voterIdLogin" required placeholder="Shkruani ID-n√´ tuaj t√´ votuesit">
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="rememberVoter" name="rememberVoter">
                        <label for="rememberVoter">M√´ kujto</label>
                    </div>
                    <button type="submit" class="btn" id="voter-login-btn">
                        <span id="voter-login-text">Hyr si Votues</span>
                        <span id="voter-login-loading" class="loading" style="display: none;"></span>
                    </button>
                </form>
                <div class="form-footer">
                    <p>Nuk keni llogari? <a href="#" onclick="showVoterRegistrationInfo()">Kontaktoni administratorin p√´r regjistrim</a></p>
                </div>
            </div>
        </section>

        <!-- User Dashboard Page -->
        <section id="user-dashboard" class="page">
            <div class="dashboard-header">
                <h1>Voto25</h1>
                <div class="dashboard-nav">
                    <a href="#" class="btn" onclick="showPage('home')">Kryefaqja</a>
                    <a href="#" class="btn btn-danger" onclick="logout()">Dil</a>
                </div>
            </div>

            <div class="user-profile">
                <h2>Mir√´sevini <span id="voter-name">Votues</span></h2>
                <h3>Mir√´sevini n√´ Platform√´n Voto25</h3>
                <p><strong>Ushtroni t√´ Drejt√´n Tuaj p√´r t√´ Votuar Kurdo, Kudo</strong></p>
                <p>Mir√´sevini n√´ platform√´n ton√´ t√´ votingut online, ku z√´ri juaj ka r√´nd√´si. Me p√´rshtatshm√´rin√´ e teknologjis√´ moderne, ne sjellim demokracin√´ n√´ majat e gisht√´rit tuaj, duke ju mund√´suar t√´ merrni pjes√´ n√´ vendime dhe zgjedhje t√´ r√´nd√´sishme nga rehatia e sht√´pis√´ suaj. Platforma jon√´ e sigurt dhe e leht√´ p√´r t'u p√´rdorur siguron q√´ vota juaj t√´ num√´rohet me sakt√´si dhe konfidencialitet.</p>
                
                <div class="profile-info">
                    <div class="info-item">
                        <strong>Emri:</strong> <span id="voter-fullname">Nuk √´sht√´ identifikuar</span>
                    </div>
                    <div class="info-item">
                        <strong>ID Votuesi:</strong> <span id="voter-id-display">Nuk √´sht√´ i disponuesh√´m</span>
                    </div>
                    <div class="info-item">
                        <strong>Qyteti:</strong> <span id="voter-city">Nuk √´sht√´ caktuar</span>
                    </div>
                    <div class="info-item">
                        <strong>Statusi i Votimit:</strong> <span id="voter-status">Nuk ka votuar</span>
                    </div>
                </div>
            </div>

            <div class="election-container">
                <h1>Zgjedhjet e P√´rgjithshme 2025</h1>
                <h2>Kandidat√´t n√´ Qytetin Tuaj: <span id="voter-city-display"></span></h2>
                
                <div id="candidates-loading-dashboard" class="alert alert-info" style="display: none;">
                    <span class="loading"></span> Duke ngarkuar kandidat√´t...
                </div>
                
                <div class="table-container">
                    <table class="candidates-table">
                        <thead>
                            <tr>
                                <th>Emri i Kandidatit</th>
                                <th>Partia</th>
                                <th>Mosha</th>
                                <th>Programi</th>
                                <th>Veprimi</th>
                            </tr>
                        </thead>
                        <tbody id="city-candidates-list">
                            <tr>
                                <td colspan="5" style="text-align: center;">Nuk ka kandidat√´ t√´ regjistruar n√´ qytetin tuaj</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Voto25. T√´ gjitha t√´ drejtat e rezervuara.</p>
            <p>Duke siguruar pjes√´marrje demokratike p√´rmes teknologjis√´.</p>
        </div>
    </footer>

    <script>
        // Konfigurimi i API-t
        const API_BASE_URL = '/api';
        let currentUser = null;
        let adminToken = null;

        // Funksionet p√´r komunikim me backend
        const api = {
            // Admin Login
            async adminLogin(code) {
                try {
                    const response = await fetch(`${API_BASE_URL}/admin/login`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ password: code })
                    });
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ admin login:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Voter Login
            async voterLogin(voterId) {
                try {
                    console.log('üîê Duke u lidhur me voter ID:', voterId);
                    const response = await fetch(`${API_BASE_URL}/voters/login`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ voterId: voterId })
                    });
                    const result = await response.json();
                    console.log('üîê P√´rgjigja nga serveri:', result);
                    return result;
                } catch (error) {
                    console.log('‚ùå Gabim n√´ voter login:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Merr t√´ gjitha partit√´ (p√´r dropdown)
            async getAllParties() {
                try {
                    const response = await fetch(`${API_BASE_URL}/parties`);
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ marrjen e partive:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Regjistro Parti
            async registerParty(partyData) {
                try {
                    const response = await fetch(`${API_BASE_URL}/parties/register`, {
                        method: 'POST',
                        headers: { 
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${adminToken}`
                        },
                        body: JSON.stringify(partyData)
                    });
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ regjistrimin e partis√´:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Regjistro Kandidat
            async registerCandidate(candidateData) {
                try {
                    const response = await fetch(`${API_BASE_URL}/candidates/register`, {
                        method: 'POST',
                        headers: { 
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${adminToken}`
                        },
                        body: JSON.stringify(candidateData)
                    });
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ regjistrimin e kandidatit:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Regjistro Votues
            async registerVoter(voterData) {
                try {
                    const response = await fetch(`${API_BASE_URL}/voters/register`, {
                        method: 'POST',
                        headers: { 
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${adminToken}`
                        },
                        body: JSON.stringify(voterData)
                    });
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ regjistrimin e votuesit:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Merr t√´ gjith√´ votuesit
            async getAllVoters() {
                try {
                    const response = await fetch(`${API_BASE_URL}/voters`);
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ marrjen e votuesve:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Merr t√´ gjith√´ kandidat√´t
            async getAllCandidates() {
                try {
                    const response = await fetch(`${API_BASE_URL}/candidates`);
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ marrjen e kandidat√´ve:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Merr t√´ gjitha partit√´ (p√´r tabel√´n e adminit)
            async getAllPartiesForTable() {
                try {
                    const response = await fetch(`${API_BASE_URL}/parties/all`);
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ marrjen e partive:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Merr kandidat√´t sipas qytetit
            async getCandidatesByCity(city) {
                try {
                    const response = await fetch(`${API_BASE_URL}/candidates/city/${city}`);
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ marrjen e kandidat√´ve:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Votimi
            async castVote(voterId, candidateId) {
                try {
                    const response = await fetch(`${API_BASE_URL}/voters/vote`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ voterId, candidateId })
                    });
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ votim:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Merr rezultatet e votimit
            async getVotingResults() {
                try {
                    const response = await fetch(`${API_BASE_URL}/results`);
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ marrjen e rezultateve:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            },

            // Merr rezultatet sipas partive
            async getPartyResults() {
                try {
                    const response = await fetch(`${API_BASE_URL}/results/parties`);
                    return await response.json();
                } catch (error) {
                    console.log('‚ùå Gabim n√´ marrjen e rezultateve t√´ partive:', error);
                    return { status: 'error', message: 'Gabim n√´ lidhjen me serverin' };
                }
            }
        };

        // Funksioni p√´r t√´ shfaqur faqen e zgjedhur
        function showPage(pageId) {
            console.log('Duke shfaqur faqen:', pageId);
            
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                page.classList.remove('active');
            });
            
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            clearForms();
            
            if (pageId === 'admin-options') {
                showTab('voters-tab');
            }
            
            if (pageId === 'user-dashboard' && currentUser) {
                loadVoterDashboard();
            }
            
            // Ngarko partit√´ kur hapet faqja e regjistrimit t√´ kandidatit
            if (pageId === 'register-candidate') {
                loadPartiesForCandidate();
            }
            
            return false;
        }

        // Mbush list√´n e partive n√´ dropdown p√´r kandidat√´t
        async function loadPartiesForCandidate() {
            try {
                const result = await api.getAllParties();
                console.log('üìã Rezultati i partive p√´r dropdown:', result);
                
                if (result.status === 'success') {
                    const partySelect = document.getElementById('candidateParty');
                    partySelect.innerHTML = '<option value="">Zgjidhni Partin√´</option>';
                    
                    // Tani result.data.parties √´sht√´ array i emrave
                    result.data.parties.forEach(partyName => {
                        const option = document.createElement('option');
                        option.value = partyName;
                        option.textContent = partyName;
                        partySelect.appendChild(option);
                    });
                    console.log('‚úÖ Partit√´ u ngarkuan n√´ dropdown:', result.data.parties);
                } else {
                    console.log('‚ùå Problem n√´ ngarkimin e partive:', result.message);
                }
            } catch (error) {
                console.log('‚ùå Gabim n√´ ngarkimin e partive:', error);
            }
        }

        // Funksioni p√´r t√´ pastruar t√´ gjitha formular√´t
        function clearForms() {
            const adminCode = document.getElementById('adminCode');
            if (adminCode) adminCode.value = '';
            
            const adminCodeError = document.getElementById('admin-code-error');
            if (adminCodeError) adminCodeError.style.display = 'none';
            
            const forms = ['party-form', 'voter-form', 'candidate-form', 'voter-login-form'];
            forms.forEach(formId => {
                const form = document.getElementById(formId);
                if (form) form.reset();
            });
            
            const errorElements = document.querySelectorAll('.alert-error');
            errorElements.forEach(element => {
                element.style.display = 'none';
            });
            
            const successElements = document.querySelectorAll('.alert-success');
            successElements.forEach(element => {
                element.style.display = 'none';
            });
        }

        // Funksioni p√´r t√´ shfaqur tab-in e zgjedhur - P√ãRDIT√ãSUAR
        function showTab(tabId) {
            console.log('Duke shfaqur tab-in:', tabId);
            
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => {
                tab.classList.remove('active');
            });
            
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            const targetTab = document.getElementById(tabId);
            if (targetTab) {
                targetTab.classList.add('active');
            }
            
            const activeTab = document.querySelector(`[onclick="showTab('${tabId}')"]`);
            if (activeTab) {
                activeTab.classList.add('active');
            }
            
            if (tabId === 'voters-tab') {
                updateVotersList();
            } else if (tabId === 'candidates-tab') {
                updateCandidatesList();
            } else if (tabId === 'parties-tab') {
                updatePartiesList();
            } else if (tabId === 'results-tab') {
                showResults();
            } else if (tabId === 'party-results-tab') {
                showPartyResults();
            }
        }

        // Verifikon kodin e administratorit
        async function verifyAdminCode() {
            const adminCodeInput = document.getElementById('adminCode');
            const errorElement = document.getElementById('admin-code-error');
            const loginBtn = document.getElementById('admin-login-btn');
            const loginText = document.getElementById('admin-login-text');
            const loading = document.getElementById('admin-loading');
            
            if (!adminCodeInput || !adminCodeInput.value) {
                if (errorElement) {
                    errorElement.textContent = 'Ju lutem shkruani kodin e administratorit';
                    errorElement.style.display = 'block';
                }
                return;
            }

            const adminCode = adminCodeInput.value;

            if (loginBtn) loginBtn.disabled = true;
            if (loginText) loginText.style.display = 'none';
            if (loading) loading.style.display = 'inline-block';
            if (errorElement) errorElement.style.display = 'none';

            try {
                const result = await api.adminLogin(adminCode);
                
                if (result.status === 'success') {
                    adminToken = result.token;
                    if (errorElement) errorElement.style.display = 'none';
                    showPage('admin-options');
                } else {
                    if (errorElement) {
                        errorElement.textContent = result.message || 'Kodi i administratorit √´sht√´ i gabuar';
                        errorElement.style.display = 'block';
                    }
                }
            } catch (error) {
                if (errorElement) {
                    errorElement.textContent = 'Gabim n√´ lidhjen me serverin. Ju lutem provoni p√´rs√´ri.';
                    errorElement.style.display = 'block';
                }
            } finally {
                if (loginBtn) loginBtn.disabled = false;
                if (loginText) loginText.style.display = 'inline-block';
                if (loading) loading.style.display = 'none';
            }
        }

        // Login i votuesit
        async function voterLogin() {
            const voterIdInput = document.getElementById('voterIdLogin');
            const errorElement = document.getElementById('voter-login-error');
            const loginBtn = document.getElementById('voter-login-btn');
            const loginText = document.getElementById('voter-login-text');
            const loading = document.getElementById('voter-login-loading');
            
            if (!voterIdInput || !voterIdInput.value) {
                if (errorElement) {
                    errorElement.textContent = 'Ju lutem shkruani ID-n√´ e votuesit';
                    errorElement.style.display = 'block';
                }
                return;
            }

            const voterId = voterIdInput.value;

            if (loginBtn) loginBtn.disabled = true;
            if (loginText) loginText.style.display = 'none';
            if (loading) loading.style.display = 'inline-block';
            if (errorElement) errorElement.style.display = 'none';

            try {
                const result = await api.voterLogin(voterId);
                
                if (result.status === 'success') {
                    currentUser = result.data.voter;
                    if (errorElement) errorElement.style.display = 'none';
                    showPage('user-dashboard');
                } else {
                    if (errorElement) {
                        errorElement.textContent = result.message || 'ID e votuesit nuk √´sht√´ e regjistruar';
                        errorElement.style.display = 'block';
                    }
                }
            } catch (error) {
                if (errorElement) {
                    errorElement.textContent = 'Gabim n√´ lidhjen me serverin. Ju lutem provoni p√´rs√´ri.';
                    errorElement.style.display = 'block';
                }
            } finally {
                if (loginBtn) loginBtn.disabled = false;
                if (loginText) loginText.style.display = 'inline-block';
                if (loading) loading.style.display = 'none';
            }
        }

        // Ngarkon dashboard-in e votuesit
        async function loadVoterDashboard() {
            if (!currentUser) return;

            const voterName = document.getElementById('voter-name');
            const voterFullname = document.getElementById('voter-fullname');
            const voterIdDisplay = document.getElementById('voter-id-display');
            const voterCity = document.getElementById('voter-city');
            const voterStatus = document.getElementById('voter-status');
            const voterCityDisplay = document.getElementById('voter-city-display');

            if (voterName) voterName.textContent = currentUser.firstName;
            if (voterFullname) voterFullname.textContent = `${currentUser.firstName} ${currentUser.lastName}`;
            if (voterIdDisplay) voterIdDisplay.textContent = currentUser.voterId;
            if (voterCity) voterCity.textContent = currentUser.city;
            if (voterCityDisplay) voterCityDisplay.textContent = currentUser.city;

            // P√ãRDIT√ãSO STATUSIN E VOTIMIT
            if (voterStatus) {
                if (currentUser.hasVoted) {
                    voterStatus.textContent = 'KA VOTUAR';
                    voterStatus.style.color = '#00FF00';
                    voterStatus.style.fontWeight = 'bold';
                } else {
                    voterStatus.textContent = 'NUK KA VOTUAR';
                    voterStatus.style.color = '#FF0000';
                }
            }

            await loadCityCandidates(currentUser.city);
        }

        // Ngarkon kandidat√´t p√´r nj√´ qytet specifik
        async function loadCityCandidates(city) {
            const loadingElement = document.getElementById('candidates-loading-dashboard');
            const candidatesList = document.getElementById('city-candidates-list');

            if (loadingElement) loadingElement.style.display = 'block';
            if (candidatesList) candidatesList.innerHTML = '<tr><td colspan="5" style="text-align: center;">Duke ngarkuar...</td></tr>';

            try {
                const result = await api.getCandidatesByCity(city);
                
                if (loadingElement) loadingElement.style.display = 'none';
                
                if (result.status === 'success' && result.data.candidates && result.data.candidates.length > 0) {
                    let html = '';
                    result.data.candidates.forEach(candidate => {
                        // KONTROLLO N√ãSE VOTUESI KA VOTUAR TASHM√ã
                        const hasVoted = currentUser.hasVoted;
                        
                        html += `
                            <tr>
                                <td>${candidate.name}</td>
                                <td>${candidate.party}</td>
                                <td>${candidate.age}</td>
                                <td>${candidate.manifesto ? candidate.manifesto.substring(0, 100) + '...' : 'Nuk ka program'}</td>
                                <td>
                                    ${!hasVoted ? 
                                        `<button class="btn btn-success" onclick="castVoteForCandidate('${candidate._id}')">VOTO</button>` : 
                                        `<button class="btn" disabled style="background-color: #ccc; color: #666;">KA VOTUAR</button>`
                                    }
                                </td>
                            </tr>
                        `;
                    });
                    if (candidatesList) candidatesList.innerHTML = html;
                } else {
                    if (candidatesList) candidatesList.innerHTML = '<tr><td colspan="5" style="text-align: center;">Nuk ka kandidat√´ t√´ regjistruar n√´ qytetin tuaj</td></tr>';
                }
            } catch (error) {
                console.error('Gabim n√´ ngarkimin e kandidat√´ve:', error);
                if (candidatesList) candidatesList.innerHTML = '<tr><td colspan="5" style="text-align: center;">Gabim n√´ ngarkimin e t√´ dh√´nave</td></tr>';
                if (loadingElement) loadingElement.style.display = 'none';
            }
        }

        // Votimi p√´r nj√´ kandidat
        async function castVoteForCandidate(candidateId) {
            if (!currentUser) {
                alert('Ju nuk jeni t√´ loguar!');
                return;
            }

            // KONTROLL M√ã I RREPT√ã N√ã FRONTEND
            if (currentUser.hasVoted) {
                alert('JU KENI VOTUAR TASHM√ã! Votimi i dyt√´ nuk lejohet.');
                return;
            }

            if (!confirm('Jeni t√´ sigurt q√´ d√´shironi t√´ votoni p√´r k√´t√´ kandidat? Vota juaj nuk mund t√´ ndryshohet.')) {
                return;
            }

            try {
                console.log('üó≥Ô∏è Duke votuar p√´r kandidatin:', candidateId);
                console.log('üë§ Votuesi:', currentUser.voterId);
                
                const result = await api.castVote(currentUser.voterId, candidateId);
                
                console.log('üì© P√´rgjigja nga serveri:', result);
                
                if (result.status === 'success') {
                    alert('VOTA JUAJ U REGJISTRUA ME SUKSES!');
                    
                    // P√ãRDIT√ãSO T√ã DH√ãNAT E VOTUESIT MENJ√ãHER√ã
                    currentUser.hasVoted = true;
                    currentUser.votedFor = candidateId;
                    
                    // P√ãRDIT√ãSO DASHBOARD-IN MENJ√ãHER√ã
                    await loadVoterDashboard();
                    
                    // P√ãRDIT√ãSO STATUSIN N√ã PROFIL
                    const voterStatus = document.getElementById('voter-status');
                    if (voterStatus) {
                        voterStatus.textContent = 'KA VOTUAR';
                        voterStatus.style.color = '#00FF00';
                        voterStatus.style.fontWeight = 'bold';
                    }

                    console.log('‚úÖ Vota u regjistrua me sukses n√´ database');

                } else {
                    console.error('‚ùå Gabim n√´ votim:', result.message);
                    alert('Gabim n√´ votim: ' + (result.message || 'Vota nuk u regjistrua'));
                }
            } catch (error) {
                console.error('‚ùå Gabim n√´ votim:', error);
                alert('Gabim n√´ lidhjen me serverin. Ju lutem provoni p√´rs√´ri.');
            }
        }

        // Shfaq rezultatet e votimit
        async function showResults() {
            const loadingElement = document.getElementById('results-loading');
            const resultsList = document.getElementById('voting-results-list');
            const totalVotesElement = document.getElementById('total-votes');
            const lastUpdatedElement = document.getElementById('last-updated');

            if (loadingElement) loadingElement.style.display = 'block';
            if (resultsList) resultsList.innerHTML = '<tr><td colspan="6" style="text-align: center;">Duke ngarkuar...</td></tr>';

            try {
                const result = await api.getVotingResults();
                
                if (loadingElement) loadingElement.style.display = 'none';
                
                if (result.status === 'success' && result.data.candidates && result.data.candidates.length > 0) {
                    let html = '';
                    let position = 1;
                    
                    result.data.candidates.forEach(candidate => {
                        // Llogarit p√´rqindjen
                        const percentage = result.data.totalVotes > 0 
                            ? ((candidate.votes / result.data.totalVotes) * 100).toFixed(1)
                            : 0;
                        
                        html += `
                            <tr>
                                <td>${position}</td>
                                <td>${candidate.name}</td>
                                <td>${candidate.party}</td>
                                <td>${candidate.city}</td>
                                <td>${candidate.votes}</td>
                                <td>${percentage}%</td>
                            </tr>
                        `;
                        position++;
                    });
                    
                    if (resultsList) resultsList.innerHTML = html;
                    
                    // P√´rdit√´so totalin e votave
                    if (totalVotesElement) {
                        totalVotesElement.textContent = result.data.totalVotes;
                    }
                    
                    // P√´rdit√´so koh√´n e fundit
                    if (lastUpdatedElement) {
                        lastUpdatedElement.textContent = new Date().toLocaleString('sq-AL');
                    }
                } else {
                    if (resultsList) resultsList.innerHTML = '<tr><td colspan="6" style="text-align: center;">Nuk ka t√´ dh√´na p√´r rezultatet e votimit</td></tr>';
                }
            } catch (error) {
                console.error('Gabim n√´ ngarkimin e rezultateve:', error);
                if (resultsList) resultsList.innerHTML = '<tr><td colspan="6" style="text-align: center;">Gabim n√´ ngarkimin e t√´ dh√´nave</td></tr>';
                if (loadingElement) loadingElement.style.display = 'none';
            }
        }

        // Shfaq rezultatet sipas partive
        async function showPartyResults() {
            const loadingElement = document.getElementById('party-results-loading');
            const resultsList = document.getElementById('party-results-list');
            const totalVotesElement = document.getElementById('total-party-votes');

            if (loadingElement) loadingElement.style.display = 'block';
            if (resultsList) resultsList.innerHTML = '<tr><td colspan="4" style="text-align: center;">Duke ngarkuar...</td></tr>';

            try {
                const result = await api.getPartyResults();
                
                if (loadingElement) loadingElement.style.display = 'none';
                
                if (result.status === 'success' && result.data.parties && result.data.parties.length > 0) {
                    let html = '';
                    let position = 1;
                    
                    result.data.parties.forEach(party => {
                        // Llogarit p√´rqindjen
                        const percentage = result.data.totalVotes > 0 
                            ? ((party.totalVotes / result.data.totalVotes) * 100).toFixed(1)
                            : 0;
                        
                        html += `
                            <tr>
                                <td>${position}</td>
                                <td>${party._id}</td>
                                <td>${party.totalVotes}</td>
                                <td>${percentage}%</td>
                            </tr>
                        `;
                        position++;
                    });
                    
                    if (resultsList) resultsList.innerHTML = html;
                    
                    // P√´rdit√´so totalin e votave
                    if (totalVotesElement) {
                        totalVotesElement.textContent = result.data.totalVotes;
                    }
                } else {
                    if (resultsList) resultsList.innerHTML = '<tr><td colspan="4" style="text-align: center;">Nuk ka t√´ dh√´na p√´r rezultatet e partive</td></tr>';
                }
            } catch (error) {
                console.error('Gabim n√´ ngarkimin e rezultateve t√´ partive:', error);
                if (resultsList) resultsList.innerHTML = '<tr><td colspan="4" style="text-align: center;">Gabim n√´ ngarkimin e t√´ dh√´nave</td></tr>';
                if (loadingElement) loadingElement.style.display = 'none';
            }
        }

        // P√´rdit√´son list√´n e votuesve
        async function updateVotersList() {
            const loadingElement = document.getElementById('voters-loading');
            const votersList = document.getElementById('registered-voters-list');

            if (loadingElement) loadingElement.style.display = 'block';
            if (votersList) votersList.innerHTML = '<tr><td colspan="7" style="text-align: center;">Duke ngarkuar...</td></tr>';

            try {
                const result = await api.getAllVoters();
                
                if (loadingElement) loadingElement.style.display = 'none';
                
                if (result.status === 'success' && result.data.voters && result.data.voters.length > 0) {
                    let html = '';
                    result.data.voters.forEach(voter => {
                        html += `
                            <tr>
                                <td>${voter.firstName}</td>
                                <td>${voter.lastName}</td>
                                <td>${voter.email}</td>
                                <td>${voter.voterId}</td>
                                <td>${voter.city}</td>
                                <td>${voter.age}</td>
                                <td>${voter.hasVoted ? 'Ka votuar' : 'Nuk ka votuar'}</td>
                            </tr>
                        `;
                    });
                    if (votersList) votersList.innerHTML = html;
                } else {
                    if (votersList) votersList.innerHTML = '<tr><td colspan="7" style="text-align: center;">Nuk ka votues t√´ regjistruar</td></tr>';
                }
            } catch (error) {
                console.error('Gabim n√´ ngarkimin e votuesve:', error);
                if (votersList) votersList.innerHTML = '<tr><td colspan="7" style="text-align: center;">Gabim n√´ ngarkimin e t√´ dh√´nave</td></tr>';
                if (loadingElement) loadingElement.style.display = 'none';
            }
        }

        // P√´rdit√´son list√´n e kandidat√´ve
        async function updateCandidatesList() {
            const loadingElement = document.getElementById('candidates-loading');
            const candidatesList = document.getElementById('registered-candidates-list');

            if (loadingElement) loadingElement.style.display = 'block';
            if (candidatesList) candidatesList.innerHTML = '<tr><td colspan="5" style="text-align: center;">Duke ngarkuar...</td></tr>';

            try {
                const result = await api.getAllCandidates();
                
                if (loadingElement) loadingElement.style.display = 'none';
                
                if (result.status === 'success' && result.data.candidates && result.data.candidates.length > 0) {
                    let html = '';
                    result.data.candidates.forEach(candidate => {
                        html += `
                            <tr>
                                <td>${candidate.name}</td>
                                <td>${candidate.party}</td>
                                <td>${candidate.city}</td>
                                <td>${candidate.age}</td>
                                <td>${candidate.qualification ? candidate.qualification.substring(0, 50) + '...' : 'Nuk ka kualifikime'}</td>
                            </tr>
                        `;
                    });
                    if (candidatesList) candidatesList.innerHTML = html;
                } else {
                    if (candidatesList) candidatesList.innerHTML = '<tr><td colspan="5" style="text-align: center;">Nuk ka kandidat√´ t√´ regjistruar</td></tr>';
                }
            } catch (error) {
                console.error('Gabim n√´ ngarkimin e kandidat√´ve:', error);
                if (candidatesList) candidatesList.innerHTML = '<tr><td colspan="5" style="text-align: center;">Gabim n√´ ngarkimin e t√´ dh√´nave</td></tr>';
                if (loadingElement) loadingElement.style.display = 'none';
            }
        }

        // P√´rdit√´son list√´n e partive
        async function updatePartiesList() {
            const loadingElement = document.getElementById('parties-loading');
            const partiesList = document.getElementById('registered-parties-list');

            if (loadingElement) loadingElement.style.display = 'block';
            if (partiesList) partiesList.innerHTML = '<tr><td colspan="5" style="text-align: center;">Duke ngarkuar...</td></tr>';

            try {
                const result = await api.getAllPartiesForTable();
                
                if (loadingElement) loadingElement.style.display = 'none';
                
                if (result.status === 'success' && result.data.parties && result.data.parties.length > 0) {
                    let html = '';
                    result.data.parties.forEach(party => {
                        html += `
                            <tr>
                                <td>${party.name}</td>
                                <td>${party.symbol}</td>
                                <td>${party.leader}</td>
                                <td>${party.foundingYear}</td>
                                <td>${party.ideology ? party.ideology.substring(0, 50) + '...' : 'Nuk ka ideologji'}</td>
                            </tr>
                        `;
                    });
                    if (partiesList) partiesList.innerHTML = html;
                } else {
                    if (partiesList) partiesList.innerHTML = '<tr><td colspan="5" style="text-align: center;">Nuk ka parti t√´ regjistruara</td></tr>';
                }
            } catch (error) {
                console.error('Gabim n√´ ngarkimin e partive:', error);
                if (partiesList) partiesList.innerHTML = '<tr><td colspan="5" style="text-align: center;">Gabim n√´ ngarkimin e t√´ dh√´nave</td></tr>';
                if (loadingElement) loadingElement.style.display = 'none';
            }
        }

        // Regjistrimi i partis√´
        async function registerParty(event) {
            event.preventDefault();
            
            const partyName = document.getElementById('partyName').value;
            const partySymbol = document.getElementById('partySymbol').value;
            const partyLeader = document.getElementById('partyLeader').value;
            const foundingYear = document.getElementById('foundingYear').value;
            const partyIdeology = document.getElementById('partyIdeology').value;

            const submitBtn = document.getElementById('party-submit-btn');
            const submitText = document.getElementById('party-submit-text');
            const loading = document.getElementById('party-loading');
            const successElement = document.getElementById('party-success');
            const errorElement = document.getElementById('party-error');

            if (submitBtn) submitBtn.disabled = true;
            if (submitText) submitText.style.display = 'none';
            if (loading) loading.style.display = 'inline-block';
            if (successElement) successElement.style.display = 'none';
            if (errorElement) errorElement.style.display = 'none';

            try {
                const result = await api.registerParty({
                    partyName: partyName,
                    partySymbol: partySymbol,
                    partyLeader: partyLeader,
                    foundingYear: foundingYear,
                    partyIdeology: partyIdeology
                });

                if (result.status === 'success') {
                    if (successElement) {
                        successElement.textContent = 'Partia u regjistrua me sukses!';
                        successElement.style.display = 'block';
                    }
                    document.getElementById('party-form').reset();
                    
                    // P√´rdit√´so tabel√´n e partive n√´ admin panel
                    updatePartiesList();
                } else {
                    if (errorElement) {
                        errorElement.textContent = result.message || 'Gabim n√´ regjistrimin e partis√´';
                        errorElement.style.display = 'block';
                    }
                }
            } catch (error) {
                if (errorElement) {
                    errorElement.textContent = 'Gabim n√´ lidhjen me serverin';
                    errorElement.style.display = 'block';
                }
            } finally {
                if (submitBtn) submitBtn.disabled = false;
                if (submitText) submitText.style.display = 'inline-block';
                if (loading) loading.style.display = 'none';
            }
        }

        // Regjistrimi i votuesit
        async function registerVoter(event) {
            event.preventDefault();
            
            if (!checkVoterAge()) return;

            const voterFirstName = document.getElementById('voterFirstName').value;
            const voterLastName = document.getElementById('voterLastName').value;
            const voterAge = document.getElementById('voterAge').value;
            const voterDob = document.getElementById('voterDob').value;
            const voterEmail = document.getElementById('voterEmail').value;
            const voterId = document.getElementById('voterId').value;
            const voterCity = document.getElementById('voterCity').value;
            const voterAddress = document.getElementById('voterAddress').value;

            const submitBtn = document.getElementById('voter-submit-btn');
            const submitText = document.getElementById('voter-submit-text');
            const loading = document.getElementById('voter-loading');
            const successElement = document.getElementById('voter-success');
            const errorElement = document.getElementById('voter-error');

            if (submitBtn) submitBtn.disabled = true;
            if (submitText) submitText.style.display = 'none';
            if (loading) loading.style.display = 'inline-block';
            if (successElement) successElement.style.display = 'none';
            if (errorElement) errorElement.style.display = 'none';

            try {
                const result = await api.registerVoter({
                    voterFirstName: voterFirstName,
                    voterLastName: voterLastName,
                    voterAge: voterAge,
                    voterDob: voterDob,
                    voterEmail: voterEmail,
                    voterId: voterId,
                    voterCity: voterCity,
                    voterAddress: voterAddress
                });

                if (result.status === 'success') {
                    if (successElement) {
                        successElement.textContent = 'Votuesi u regjistrua me sukses!';
                        successElement.style.display = 'block';
                    }
                    document.getElementById('voter-form').reset();
                    
                    // P√´rdit√´so tabel√´n e votuesve n√´ admin panel
                    updateVotersList();
                } else {
                    if (errorElement) {
                        errorElement.textContent = result.message || 'Gabim n√´ regjistrimin e votuesit';
                        errorElement.style.display = 'block';
                    }
                }
            } catch (error) {
                if (errorElement) {
                    errorElement.textContent = 'Gabim n√´ lidhjen me serverin';
                    errorElement.style.display = 'block';
                }
            } finally {
                if (submitBtn) submitBtn.disabled = false;
                if (submitText) submitText.style.display = 'inline-block';
                if (loading) loading.style.display = 'none';
            }
        }

        // Regjistrimi i kandidatit
        async function registerCandidate(event) {
            event.preventDefault();
            
            if (!checkCandidateAge()) return;

            const candidateName = document.getElementById('candidateName').value;
            const candidateParty = document.getElementById('candidateParty').value;
            const candidateCity = document.getElementById('candidateCity').value;
            const candidateAge = document.getElementById('candidateAge').value;
            const candidateDob = document.getElementById('candidateDob').value;
            const candidateQualification = document.getElementById('candidateQualification').value;
            const candidateManifesto = document.getElementById('candidateManifesto').value;

            const submitBtn = document.getElementById('candidate-submit-btn');
            const submitText = document.getElementById('candidate-submit-text');
            const loading = document.getElementById('candidate-loading');
            const successElement = document.getElementById('candidate-success');
            const errorElement = document.getElementById('candidate-error');

            if (submitBtn) submitBtn.disabled = true;
            if (submitText) submitText.style.display = 'none';
            if (loading) loading.style.display = 'inline-block';
            if (successElement) successElement.style.display = 'none';
            if (errorElement) errorElement.style.display = 'none';

            try {
                const result = await api.registerCandidate({
                    candidateName: candidateName,
                    candidateParty: candidateParty,
                    candidateCity: candidateCity,
                    candidateAge: candidateAge,
                    candidateDob: candidateDob,
                    candidateQualification: candidateQualification,
                    candidateManifesto: candidateManifesto
                });

                if (result.status === 'success') {
                    if (successElement) {
                        successElement.textContent = 'Kandidati u regjistrua me sukses!';
                        successElement.style.display = 'block';
                    }
                    document.getElementById('candidate-form').reset();
                    
                    // P√´rdit√´so tabel√´n e kandidat√´ve n√´ admin panel
                    updateCandidatesList();
                } else {
                    if (errorElement) {
                        errorElement.textContent = result.message || 'Gabim n√´ regjistrimin e kandidatit';
                        errorElement.style.display = 'block';
                    }
                }
            } catch (error) {
                if (errorElement) {
                    errorElement.textContent = 'Gabim n√´ lidhjen me serverin';
                    errorElement.style.display = 'block';
                }
            } finally {
                if (submitBtn) submitBtn.disabled = false;
                if (submitText) submitText.style.display = 'inline-block';
                if (loading) loading.style.display = 'none';
            }
        }

        // Funksionet e kontrollit t√´ mosh√´s
        function checkVoterAge() {
            const ageInput = document.getElementById('voterAge');
            const errorElement = document.getElementById('voter-age-error');
            
            if (!ageInput || !errorElement) return true;
            
            const age = parseInt(ageInput.value);
            
            if (age < 18) {
                errorElement.style.display = 'block';
                return false;
            } else {
                errorElement.style.display = 'none';
                return true;
            }
        }

        function checkCandidateAge() {
            const ageInput = document.getElementById('candidateAge');
            const errorElement = document.getElementById('candidate-age-error');
            
            if (!ageInput || !errorElement) return true;
            
            const age = parseInt(ageInput.value);
            
            if (age < 25) {
                errorElement.style.display = 'block';
                return false;
            } else {
                errorElement.style.display = 'none';
                return true;
            }
        }

        function calculateVoterAge() {
            const dobInput = document.getElementById('voterDob');
            const ageInput = document.getElementById('voterAge');
            
            if (!dobInput || !ageInput) return;
            
            const dob = new Date(dobInput.value);
            const today = new Date();
            const age = today.getFullYear() - dob.getFullYear();
            ageInput.value = age;
            checkVoterAge();
        }

        function calculateCandidateAge() {
            const dobInput = document.getElementById('candidateDob');
            const ageInput = document.getElementById('candidateAge');
            
            if (!dobInput || !ageInput) return;
            
            const dob = new Date(dobInput.value);
            const today = new Date();
            const age = today.getFullYear() - dob.getFullYear();
            ageInput.value = age;
            checkCandidateAge();
        }

        function showVoterRegistrationInfo() {
            alert("P√´r t√´ u regjistruar si votues, ju lutem kontaktoni administratorin e sistemit. Votuesit duhet t√´ verifikohen dhe regjistrohen nga administratori p√´rpara se t√´ mund t√´ votojn√´.");
        }

        // Verifiko statusin e votimit n√´ m√´nyr√´ periodike
        async function checkVoteStatus() {
            if (!currentUser) return;
            
            try {
                const result = await api.voterLogin(currentUser.voterId);
                if (result.status === 'success') {
                    // P√´rdit√´so statusin lokal
                    currentUser.hasVoted = result.data.voter.hasVoted;
                    
                    // N√´se ka ndryshuar statusi, p√´rdit√´so pamjen
                    if (currentUser.hasVoted) {
                        loadVoterDashboard();
                    }
                }
            } catch (error) {
                console.log('Gabim n√´ verifikimin e statusit:', error);
            }
        }

        function logout() {
            currentUser = null;
            adminToken = null;
            showPage('home');
            
            const voterStatus = document.getElementById('voter-status');
            if (voterStatus) {
                voterStatus.textContent = 'Nuk ka votuar';
                voterStatus.style.color = '';
                voterStatus.style.fontWeight = '';
            }
            
            const voterFullname = document.getElementById('voter-fullname');
            if (voterFullname) voterFullname.textContent = 'Nuk √´sht√´ identifikuar';
            
            const voterIdDisplay = document.getElementById('voter-id-display');
            if (voterIdDisplay) voterIdDisplay.textContent = 'Nuk √´sht√´ i disponuesh√´m';
            
            const voterCity = document.getElementById('voter-city');
            if (voterCity) voterCity.textContent = 'Nuk √´sht√´ caktuar';
            
            const voterName = document.getElementById('voter-name');
            if (voterName) voterName.textContent = 'Votues';
        }

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Voto25 u ngarkua me sukses!');
            
            document.querySelectorAll('.choice-card').forEach(card => {
                card.addEventListener('click', function() {
                    const onclickAttr = this.getAttribute('onclick');
                    if (onclickAttr) {
                        const match = onclickAttr.match(/showPage\('([^']+)'\)/);
                        if (match && match[1]) {
                            showPage(match[1]);
                        }
                    }
                });
            });

            const partyForm = document.getElementById('party-form');
            if (partyForm) {
                partyForm.addEventListener('submit', registerParty);
            }

            const voterForm = document.getElementById('voter-form');
            if (voterForm) {
                voterForm.addEventListener('submit', registerVoter);
            }

            const candidateForm = document.getElementById('candidate-form');
            if (candidateForm) {
                candidateForm.addEventListener('submit', registerCandidate);
            }

            const voterLoginForm = document.getElementById('voter-login-form');
            if (voterLoginForm) {
                voterLoginForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    voterLogin();
                });
            }

            // Verifiko statusin e votimit √ßdo 30 sekonda kur √´sht√´ n√´ dashboard
            setInterval(() => {
                if (document.getElementById('user-dashboard')?.classList.contains('active')) {
                    checkVoteStatus();
                }
            }, 30000);

            showPage('home');
        });
    </script>
</body>
</html>